@model FinanceApp.Web.Models.SubscriptionViewModel
@using FinanceApp.Domain.Enums
@{
    ViewData["Title"] = "Subscription";
}

<div class="mb-4">
    <h1 class="visually-hidden">Subscription</h1>
    <p class="page-subtitle mb-2">Your current plan is <strong>@Model.CurrentPlan</strong>.</p>
    <p class="text-muted small mb-0">Assigned on @Model.SubscriptionAssignedAt.ToLocalTime().ToString("yyyy-MM-dd HH:mm").</p>
</div>

@if (TempData["SubscriptionSuccess"] is string success)
{
    <div class="alert alert-success" role="alert">@success</div>
}
@if (TempData["SubscriptionError"] is string error)
{
    <div class="alert alert-danger" role="alert">@error</div>
}
@if (TempData["SubscriptionInfo"] is string info)
{
    <div class="alert alert-info" role="alert">@info</div>
}

<div class="row g-3">
    <div class="col-md-4">
        <div class="card h-100 @(Model.CurrentPlan == SubscriptionPlan.Free ? "border-primary" : "")">
            <div class="card-body">
                <h5 class="card-title mb-2">Free</h5>
                <p class="text-muted small mb-3">Starter access for personal finance tracking.</p>
                @if (Model.CurrentPlan == SubscriptionPlan.Free)
                {
                    <span class="badge bg-primary">Current plan</span>
                }
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card h-100 @(Model.CurrentPlan == SubscriptionPlan.Pro ? "border-success" : "")">
            <div class="card-body d-flex flex-column">
                <h5 class="card-title mb-2">Pro</h5>
                <p class="text-muted small mb-3">More advanced insights and upcoming premium features.</p>
                <div class="mt-auto">
                    @if (Model.CurrentPlan == SubscriptionPlan.Pro)
                    {
                        <span class="badge bg-success">Current plan</span>
                    }
                    else
                    {
                        <form asp-action="Upgrade" method="post">
                            <input type="hidden" name="plan" value="Pro" />
                            <button type="submit" class="btn btn-success btn-sm">Upgrade to Pro</button>
                        </form>
                    }
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card h-100 @(Model.CurrentPlan == SubscriptionPlan.Premium ? "border-warning" : "")">
            <div class="card-body d-flex flex-column">
                <h5 class="card-title mb-2">Premium</h5>
                <p class="text-muted small mb-3">Top-tier experience with future advanced automation features.</p>
                <div class="mt-auto">
                    @if (Model.CurrentPlan == SubscriptionPlan.Premium)
                    {
                        <span class="badge bg-warning text-dark">Current plan</span>
                    }
                    else
                    {
                        <form asp-action="Upgrade" method="post">
                            <input type="hidden" name="plan" value="Premium" />
                            <button type="submit" class="btn btn-warning btn-sm text-dark">Upgrade to Premium</button>
                        </form>
                    }
                </div>
            </div>
        </div>
    </div>
</div>
